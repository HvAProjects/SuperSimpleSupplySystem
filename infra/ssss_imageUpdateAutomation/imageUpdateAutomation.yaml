apiVersion: image.toolkit.fluxcd.io/v1alpha1
kind: ImageUpdateAutomation
metadata:
  name: ssss-backend
  namespace: flux-system
spec:
  checkout:
    branch: k8s
    gitRepositoryRef:
      name: flux-system
  commit:
    messageTemplate: |
      Automated image update

      Automation name: {{ .AutomationObject }}

      Files:
      {{ range $filename, $_ := .Updated.Files -}}
      - {{ $filename }}
      {{ end -}}

      Objects:
      {{ range $resource, $_ := .Updated.Objects -}}
      - {{ $resource.Kind }} {{ $resource.Name }}
      {{ end -}}

      Images:
      {{ range .Updated.Images -}}
      - {{.}}
      {{ end -}}

      [skip ci]
    authorEmail: flux@example.com
    authorName: flux
  interval: 1m0s
  push:
    branch: k8s
  update:
    path: ./infra/ssss
    strategy: Setters